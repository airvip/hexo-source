---
title: Excel对比两列的相同项与不同项
date: 2018-06-06 11:02:22
tags: 
    - Excel
---

> 你的坚持，在他看来只是个笑话！

工作中，我们导出的数据一般都是保存为 Excel 格式的文档，有时候需要对比两列的数据是否一致，并把不同的数据表示出来。如果靠我们人工查找，不仅费时费力，还有可能出现遗漏。我们通过 Excel 自带的一些方法就非常简单的来处理这项任务。

<!-- more -->

# 原始数据

| | A   | B    |
|---- |---- | ---- |
| 1|1234567 | 	3569877 |
| 2|5684258 |	1234567 |
| 3|4355846 |	6358452 |
| 4|4554622 |	5648826 |
| 5|3569877 |	5684258 |

![origin_date](/img/201806/excel_diff/origin.jpg)

# 对比操作

在 C 列标出 A 列中的数据是否在 B 列中存在

方式一：简单对比

操作：在 C1 单元格中输入 `=MATCH(A1,B:B,)` 该公式并回车【enter键】，然后在 C 列下拉公式，使每个 C 列的单元格都应用该公式。
结果：看 C 列的值，以 C1 为例，2 表示 A1 单元格的内容再 B 列里第 2 行存在，即：A1 == B2; 如果 A 列的内容再 B 列里没有就返回错误值 #N/A

![diff_date1](/img/201806/excel_diff/diff1.jpg)

方式二：优化对比

如果认为错误值不够优雅，可以将公式改成 `=ISNUMBER(MATCH(A1,B:B,))`,ISNUMBER 判断返回值是不是数字，如果是数字就返回 TRUE，反之返回 FALSE。
结果：TRUE 表示 A 列中的数据在 B 列存在；FALSE 表示 A 列中的数据在 B 列不存在。 

![diff_date2](/img/201806/excel_diff/diff2.jpg)

我们同样可以使用 `=COUNTIF(B:B,A1)` 公式进行对比。
COUNTIF：统计在某个范围内,满足既定条件的单元格的个数
结果：如果 C 列返回的是大于 0 的数字（因为 B 列里可能有重复出现 A 列某个单元格内容）就说明 A 列内容在 B 列里出现过，反之是 0 的话就是没有出现过。

![diff_date3](/img/201806/excel_diff/diff3.jpg)

方式三：自定义返回值

如果想要自定义显示信息，可以将公式改成 `=IF(ISNUMBER(MATCH(A1,B:B,)),"存在","不存在")`
结果：存在 表示 A 列中的数据在 B 列存在；不存在 表示 A 列中的数据在 B 列不存在。

![diff_date4](/img/201806/excel_diff/diff4.jpg)

